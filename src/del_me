#include <immintrin.h>
static inline __m256i hsum_8x8x32(__m256i v0, __m256i v1)
{
    // cannot be global as is function call :c -> maybe macro
    __m256i permute_idx = _mm256_set_epi32(7, 5, 3, 1, 6, 4, 2, 0);
    __m256i v04 = _mm256_hadd_epi32(v0, v1);
    // now idx: 76543210 -> 76543210
    //     val: 40404040 -> 44440000
    __m256i v04p = _mm256_permutevar8x32_epi32(v04, permute_idx);
}


__m256i foo(__m256i v0, __m256i v1)
{
    return hsum_8x8x32(v0, v1);
}